
#import <Foundation/Foundation.h>

NSString *StringFromFrontalCortexData(Byte *data);


//: zh_strings
Byte kStr_moveDentedValue[] = {39, 10, 11, 105, 8, 43, 195, 220, 88, 144, 81, 115, 103, 110, 105, 114, 116, 115, 95, 104, 122, 144};


//: fr_strings
Byte kStr_rangeText[] = {90, 10, 3, 115, 103, 110, 105, 114, 116, 115, 95, 114, 102, 59};


//: th_strings
Byte kStr_accountingValue[] = {59, 10, 3, 115, 103, 110, 105, 114, 116, 115, 95, 104, 116, 136};


//: hant
Byte kStr_formulaData[] = {93, 4, 8, 135, 8, 20, 77, 199, 116, 110, 97, 104, 247};


//: main_tab_my
Byte kStr_notionPointedExpoText[] = {70, 11, 9, 57, 35, 244, 37, 193, 111, 121, 109, 95, 98, 97, 116, 95, 110, 105, 97, 109, 171};


//: eg_strings
Byte kStr_strangeName[] = {33, 10, 11, 103, 101, 205, 185, 252, 208, 167, 10, 115, 103, 110, 105, 114, 116, 115, 95, 103, 101, 79};


//: en_strings
Byte kStr_helmViaCoverData[] = {28, 10, 4, 84, 115, 103, 110, 105, 114, 116, 115, 95, 110, 101, 207};


//: name
Byte kStr_drivingTacticTianTitle[] = {62, 4, 11, 10, 251, 1, 82, 202, 113, 45, 92, 101, 109, 97, 110, 30};


//: string
Byte kStr_stairsTeeData[] = {35, 6, 5, 176, 7, 103, 110, 105, 114, 116, 115, 222};


//: vi_strings
Byte kStr_realizeData[] = {41, 10, 8, 199, 16, 204, 217, 51, 115, 103, 110, 105, 114, 116, 115, 95, 105, 118, 124};


//: de_strings
Byte kStr_blanketTitle[] = {93, 10, 8, 2, 213, 198, 113, 53, 115, 103, 110, 105, 114, 116, 115, 95, 101, 100, 174};


//: id_strings
Byte kStr_bankingData[] = {64, 10, 12, 102, 9, 163, 255, 5, 164, 199, 192, 198, 115, 103, 110, 105, 114, 116, 115, 95, 100, 105, 167};


//: sa_strings
Byte kStr_backgroundData[] = {25, 10, 3, 115, 103, 110, 105, 114, 116, 115, 95, 97, 115, 70};


//: %@/%@.xml
Byte kStr_billProofContent[] = {76, 9, 3, 108, 109, 120, 46, 64, 37, 47, 64, 37, 45};


//: ko_strings
Byte kStr_saltAgainstContent[] = {87, 10, 4, 116, 115, 103, 110, 105, 114, 116, 115, 95, 111, 107, 43};


//: zh_hant_strings
Byte kStr_saltBureauYeName[] = {88, 15, 9, 21, 2, 28, 72, 173, 141, 115, 103, 110, 105, 114, 116, 115, 95, 116, 110, 97, 104, 95, 104, 122, 122};


//: it_strings
Byte kStr_diplomaImageData[] = {29, 10, 5, 197, 7, 115, 103, 110, 105, 114, 116, 115, 95, 116, 105, 130};


//: text
Byte kStr_scrimTitle[] = {34, 4, 11, 53, 174, 164, 244, 28, 173, 159, 214, 116, 120, 101, 116, 216};


//: ja_strings
Byte kStr_deliveryTacticConservativeName[] = {34, 10, 10, 224, 125, 166, 124, 134, 199, 232, 115, 103, 110, 105, 114, 116, 115, 95, 97, 106, 201};


//: pk_strings
Byte kStr_fanTitle[] = {72, 10, 9, 196, 93, 193, 208, 222, 250, 115, 103, 110, 105, 114, 116, 115, 95, 107, 112, 70};


//: pt_strings
Byte kStr_sonAbilityName[] = {57, 10, 5, 178, 105, 115, 103, 110, 105, 114, 116, 115, 95, 116, 112, 136};


//: ru_strings
Byte kStr_grossText[] = {66, 10, 3, 115, 103, 110, 105, 114, 116, 115, 95, 117, 114, 23};


//: bd_strings
Byte kStr_combineDeclareData[] = {21, 10, 5, 105, 202, 115, 103, 110, 105, 114, 116, 115, 95, 100, 98, 118};


//: ug_strings
Byte kStr_thyName[] = {39, 10, 7, 245, 12, 67, 124, 115, 103, 110, 105, 114, 116, 115, 95, 103, 117, 177};


//: tr_strings
Byte kStr_rubData[] = {98, 10, 10, 27, 27, 12, 209, 156, 116, 169, 115, 103, 110, 105, 114, 116, 115, 95, 114, 116, 25};


//: spa_strings
Byte kStr_civilianText[] = {80, 11, 3, 115, 103, 110, 105, 114, 116, 115, 95, 97, 112, 115, 50};


//: hi_strings
Byte kStr_bothTitle[] = {68, 10, 9, 50, 115, 224, 112, 81, 98, 115, 103, 110, 105, 114, 116, 115, 95, 105, 104, 153};


//: resources
Byte kStr_cousinData[] = {25, 9, 3, 115, 101, 99, 114, 117, 111, 115, 101, 114, 62};


//: zh_CN
Byte kStr_gritOutsideValue[] = {40, 5, 3, 78, 67, 95, 104, 122, 35};


//: spa
Byte kStr_meantimeName[] = {6, 3, 11, 42, 75, 212, 84, 245, 235, 133, 255, 97, 112, 115, 199};

// __DEBUG__
// __CLOSE_PRINT__
//
//  LabelCell.m
//  NIM
//
//  Created by 彭爽 on 2022/6/24.
//  Copyright © 2022 Netease. All rights reserved.
//

// __M_A_C_R_O__
//: #import "NTESLanguageManager.h"
#import "LabelCell.h"
//: #import "XMLReader.h"
#import "BeReader.h"
//: #import "AppleProjectKit.h"
#import "On.h"
//: #import "SSZipArchiveManager.h"
#import "OnManager.h"

//: @interface NTESLanguageManager ()<NSXMLParserDelegate>
@interface LabelCell ()<NSXMLParserDelegate>
//: @property (nonatomic ,strong) NSString *currentElementName;
@property (nonatomic ,strong) NSString *currentElementName;
//: @end
@end

//: @implementation NTESLanguageManager
@implementation LabelCell

//: static NTESLanguageManager *shareInstance = nil;
static LabelCell *kConst_pathHourTapName = nil;

//: + (NTESLanguageManager *)shareInstance{
+ (LabelCell *)nameAcross{
    //: @synchronized(self) {
    @synchronized(self) {
        //: if (shareInstance == nil) {
        if (kConst_pathHourTapName == nil) {
            //: shareInstance = [[NTESLanguageManager alloc] init];
            kConst_pathHourTapName = [[LabelCell alloc] init];
            //: shareInstance.langDict = [NSMutableDictionary dictionaryWithCapacity:100];
            kConst_pathHourTapName.langDict = [NSMutableDictionary dictionaryWithCapacity:100];
        }
        //: return shareInstance;
        return kConst_pathHourTapName;
    }
}

//: + (NSString *)getTextWithKey:(NSString *)key{
+ (NSString *)tinkleKey:(NSString *)key{
    //: NSMutableDictionary *dict = [NTESLanguageManager shareInstance].langDict;
    NSMutableDictionary *dict = [LabelCell nameAcross].langDict;
    //: NSString *value = [dict objectForKey:key];
    NSString *value = [dict objectForKey:key];
    //: if (value == nil ) {
    if (value == nil ) {
        //: NSLog(@"value为空========%@",key);
        //: value = @"";
        value = @"";

    }
    //: return value;
    return value;
}

//: - (void)setLanguagre:(NSString *)langType{
- (void)setMode:(NSString *)langType{

//    [self.langDict removeAllObjects];

    //: NSString *resourceType = @"zh_strings";
    NSString *resourceType = StringFromFrontalCortexData(kStr_moveDentedValue);
    //: if ([langType isEqualToString:@"en"]) {
    if ([langType isEqualToString:@"en"]) {
        //: resourceType = @"en_strings";
        resourceType = StringFromFrontalCortexData(kStr_helmViaCoverData);
    //: }else if ([langType isEqualToString:@"th"]){
    }else if ([langType isEqualToString:@"th"]){
        //: resourceType = @"th_strings";
        resourceType = StringFromFrontalCortexData(kStr_accountingValue);
    //: }else if ([langType isEqualToString:@"vi"]){
    }else if ([langType isEqualToString:@"vi"]){
        //: resourceType = @"vi_strings";
        resourceType = StringFromFrontalCortexData(kStr_realizeData);
    //: }else if ([langType isEqualToString:@"hi"]){
    }else if ([langType isEqualToString:@"hi"]){
        //: resourceType = @"hi_strings";
        resourceType = StringFromFrontalCortexData(kStr_bothTitle);
    //: }else if ([langType isEqualToString:@"ja"]){
    }else if ([langType isEqualToString:@"ja"]){
        //: resourceType = @"ja_strings";
        resourceType = StringFromFrontalCortexData(kStr_deliveryTacticConservativeName);
    //: }else if ([langType isEqualToString:@"ko"]){
    }else if ([langType isEqualToString:@"ko"]){
        //: resourceType = @"ko_strings";
        resourceType = StringFromFrontalCortexData(kStr_saltAgainstContent);
    //: }else if ([langType isEqualToString:@"spa"]){
    }else if ([langType isEqualToString:StringFromFrontalCortexData(kStr_meantimeName)]){
        //: resourceType = @"spa_strings";
        resourceType = StringFromFrontalCortexData(kStr_civilianText);
    //: }else if ([langType isEqualToString:@"pt"]){
    }else if ([langType isEqualToString:@"pt"]){
        //: resourceType = @"pt_strings";
        resourceType = StringFromFrontalCortexData(kStr_sonAbilityName);
    //: }else if ([langType isEqualToString:@"id"]){
    }else if ([langType isEqualToString:@"id"]){
        //: resourceType = @"id_strings";
        resourceType = StringFromFrontalCortexData(kStr_bankingData);
    //: }else if ([langType isEqualToString:@"it"]){
    }else if ([langType isEqualToString:@"it"]){
        //: resourceType = @"it_strings";
        resourceType = StringFromFrontalCortexData(kStr_diplomaImageData);
    //: }else if ([langType isEqualToString:@"eg"]){
    }else if ([langType isEqualToString:@"eg"]){
        //: resourceType = @"eg_strings";
        resourceType = StringFromFrontalCortexData(kStr_strangeName);
    //: }else if ([langType isEqualToString:@"tr"]){
    }else if ([langType isEqualToString:@"tr"]){
        //: resourceType = @"tr_strings";
        resourceType = StringFromFrontalCortexData(kStr_rubData);
    //: }else if ([langType isEqualToString:@"ug"]){
    }else if ([langType isEqualToString:@"ug"]){
        //: resourceType = @"ug_strings";
        resourceType = StringFromFrontalCortexData(kStr_thyName);
    //: }else if ([langType isEqualToString:@"de"]){
    }else if ([langType isEqualToString:@"de"]){
        //: resourceType = @"de_strings";
        resourceType = StringFromFrontalCortexData(kStr_blanketTitle);
    //: }else if ([langType isEqualToString:@"pk"]){
    }else if ([langType isEqualToString:@"pk"]){
        //: resourceType = @"pk_strings";
        resourceType = StringFromFrontalCortexData(kStr_fanTitle);
    //: }else if ([langType isEqualToString:@"sa"]){
    }else if ([langType isEqualToString:@"sa"]){
        //: resourceType = @"sa_strings";
        resourceType = StringFromFrontalCortexData(kStr_backgroundData);
    //: }else if ([langType isEqualToString:@"ru"]){
    }else if ([langType isEqualToString:@"ru"]){
        //: resourceType = @"ru_strings";
        resourceType = StringFromFrontalCortexData(kStr_grossText);
    //: }else if ([langType isEqualToString:@"bd"]){
    }else if ([langType isEqualToString:@"bd"]){
        //: resourceType = @"bd_strings";
        resourceType = StringFromFrontalCortexData(kStr_combineDeclareData);
    //: }else if ([langType isEqualToString:@"fr"]){
    }else if ([langType isEqualToString:@"fr"]){
        //: resourceType = @"fr_strings";
        resourceType = StringFromFrontalCortexData(kStr_rangeText);
    //: }else if ([langType isEqualToString:@"hant"]){
    }else if ([langType isEqualToString:StringFromFrontalCortexData(kStr_formulaData)]){
        //: resourceType = @"zh_hant_strings";
        resourceType = StringFromFrontalCortexData(kStr_saltBureauYeName);
    }

    //: NSString *xmlFilePath = [[[SSZipArchiveManager sharedManager] getXML_filePath] stringByAppendingPathComponent:[NSString stringWithFormat:@"%@/%@.xml", langType, resourceType]];
    NSString *xmlFilePath = [[[OnManager directorLength] nameFor] stringByAppendingPathComponent:[NSString stringWithFormat:StringFromFrontalCortexData(kStr_billProofContent), langType, resourceType]];

    //: if (![[NSFileManager defaultManager] fileExistsAtPath:xmlFilePath]) {
    if (![[NSFileManager defaultManager] fileExistsAtPath:xmlFilePath]) {
        //: NSLog(@"XML file not found at path: %@", xmlFilePath);
        //: return;
        return;
    }

    //: NSData *xmlData = [NSData dataWithContentsOfFile:xmlFilePath];
    NSData *xmlData = [NSData dataWithContentsOfFile:xmlFilePath];
    //: if (!xmlData) {
    if (!xmlData) {
        //: NSLog(@"Failed to load XML data from file: %@", xmlFilePath);
        //: return;
        return;
    }

    //: NSError *error = nil;
    NSError *error = nil;
    //: if (error) {
    if (error) {
        //: NSLog(@"error : %@", error);
    }
    //: NSDictionary *result = [XMLReader dictionaryForXMLData:xmlData error:&error];
    NSDictionary *result = [BeReader viewUser:xmlData convert_autoreleasing:&error];
//    NSDictionary *result = [NSDictionary dictionaryWithXML:xmlData];

    //: NSLog(@"result : %@", result);
    //: if (result) {
    if (result) {
        //: NSDictionary *resources = [result objectForKey:@"resources"];
        NSDictionary *resources = [result objectForKey:StringFromFrontalCortexData(kStr_cousinData)];
        //: if (resources) {
        if (resources) {
            //: NSArray *string = [resources objectForKey:@"string"];
            NSArray *string = [resources objectForKey:StringFromFrontalCortexData(kStr_stairsTeeData)];
            //: if (string.count > 0) {
            if (string.count > 0) {
                //: [string enumerateObjectsUsingBlock:^(NSDictionary *obj, NSUInteger idx, BOOL * _Nonnull stop) {
                [string enumerateObjectsUsingBlock:^(NSDictionary *obj, NSUInteger idx, BOOL * _Nonnull stop) {
                    //: NSString *name = [obj objectForKey:@"name"];
                    NSString *name = [obj objectForKey:StringFromFrontalCortexData(kStr_drivingTacticTianTitle)];
                    //: NSString *text = [obj objectForKey:@"text"];
                    NSString *text = [obj objectForKey:StringFromFrontalCortexData(kStr_scrimTitle)];
                    //: [self.langDict setObject:text forKey:name];
                    [self.langDict setObject:text forKey:name];
                //: }];
                }];
            }
        }

//        NSArray *string = [result objectForKey:@"string"];
//        if (string.count > 0) {
//            [string enumerateObjectsUsingBlock:^(NSDictionary *obj, NSUInteger idx, BOOL * _Nonnull stop) {
//                NSString *name = [obj objectForKey:@"name"];
//                NSString *text = [obj objectForKey:@"_text"];
//                [self.langDict setObject:text forKey:name];
//            }];
//        }
    }
}

// 开始
//: - (void)parserDidStartDocument:(NSXMLParser *)parser {
- (void)parserDidStartDocument:(NSXMLParser *)parser {

    //: NSLog(@"开始");
}
//: - (void)parser:(NSXMLParser *)parser parseErrorOccurred:(NSError *)parseError{
- (void)parser:(NSXMLParser *)parser parseErrorOccurred:(NSError *)parseError{
    //: NSLog(@"出错");
}

// 获取节点头
//: - (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName attributes:(NSDictionary<NSString *,NSString *> *)attributeDict {
- (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName attributes:(NSDictionary<NSString *,NSString *> *)attributeDict {

    //: if ([elementName isEqualToString:@"string"]) {
    if ([elementName isEqualToString:StringFromFrontalCortexData(kStr_stairsTeeData)]) {
        //: self.currentElementName = attributeDict[@"name"];
        self.currentElementName = attributeDict[StringFromFrontalCortexData(kStr_drivingTacticTianTitle)];
        //NSLog(@"--------%@",_currentElementName);
    }

}

// 获取节点的值 (这个方法在获取到节点头和节点尾后，会分别调用一次)
//: - (void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string {
- (void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string {
    //: if (_currentElementName != nil) {
    if (_currentElementName != nil) {
        //: if ([_currentElementName isEqualToString:@"main_tab_my"]) {
        if ([_currentElementName isEqualToString:StringFromFrontalCortexData(kStr_notionPointedExpoText)]) {
            //: NSLog(@"%@",string);
        }
        //: [self.langDict setObject:string forKey:_currentElementName];
        [self.langDict setObject:string forKey:_currentElementName];
    }
}

// 获取节点尾
//: - (void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName {
- (void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName {

    //: _currentElementName = nil;
    _currentElementName = nil;
//    NSLog(@"end element : %@---%@----%@", elementName,namespaceURI,qName);


}

// 结束
//: - (void)parserDidEndDocument:(NSXMLParser *)parser {
- (void)parserDidEndDocument:(NSXMLParser *)parser {

    //: NSLog(@"结束");
    //: NSLog(@"%@",self.langDict);

    //发送修改语言通知

}

//: + (NSString *)getLocale{
+ (NSString *)distributor{//th-TH  vi-VN
//    NSString *language = [AlongDefaults standardUserDefaults].language;
    //: NSString *locale = @"zh_CN";
    NSString *locale = StringFromFrontalCortexData(kStr_gritOutsideValue);
//    if ([language isEqualToString:@"en"]) {
//        return @"en_US";
//    }
    //: return locale;
    return locale;
}


//: @end
@end

Byte * FrontalCortexDataToCache(Byte *data) {
    int reelDriver = data[0];
    int overexpose = data[1];
    int counselor = data[2];
    if (!reelDriver) return data + counselor;
    for (int i = 0; i < overexpose / 2; i++) {
        int begin = counselor + i;
        int end = counselor + overexpose - i - 1;
        Byte temp = data[begin];
        data[begin] = data[end];
        data[end] = temp;
    }
    data[0] = 0;
    data[counselor + overexpose] = 0;
    return data + counselor;
}

NSString *StringFromFrontalCortexData(Byte *data) {
    return [NSString stringWithUTF8String:(char *)FrontalCortexDataToCache(data)];
}  
