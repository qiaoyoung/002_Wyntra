
#import <Foundation/Foundation.h>
typedef struct {
    Byte stock;
    Byte *classic;
    unsigned int column;
    bool thanatos;
	int toilet;
	int successLegally;
} NameureData;

NSString *StringFromNameureData(NameureData *data);


//: redPacketSendID
NameureData kStr_regulatoryText = (NameureData){156, (Byte []){238, 249, 248, 204, 253, 255, 247, 249, 232, 207, 249, 242, 248, 213, 216, 197}, 15, false, 138, 216};


//: openPacketId
NameureData kStr_objectTunValue = (NameureData){139, (Byte []){228, 251, 238, 229, 219, 234, 232, 224, 238, 255, 194, 239, 231}, 12, false, 230, 15};


//: messageAbstract
NameureData kStr_trulyTingWillingnessName = (NameureData){253, (Byte []){144, 152, 142, 142, 156, 154, 152, 188, 159, 142, 137, 143, 156, 158, 137, 78}, 15, false, 155, 133};


//: title
NameureData kStr_lawmakerName = (NameureData){242, (Byte []){134, 155, 134, 158, 151, 87}, 5, false, 154, 138};


//: fired
NameureData kStr_sayContent = (NameureData){142, (Byte []){232, 231, 252, 235, 234, 181}, 5, false, 111, 140};


//: redPacketId
NameureData kStr_imageLegallyText = (NameureData){232, (Byte []){154, 141, 140, 184, 137, 139, 131, 141, 156, 161, 140, 46}, 11, false, 227, 154};


//: fileName
NameureData kStr_withHeyContent = (NameureData){94, (Byte []){56, 55, 50, 59, 16, 63, 51, 59, 66}, 8, false, 160, 45};


//: isGetDone
NameureData kStr_therapyTitle = (NameureData){204, (Byte []){165, 191, 139, 169, 184, 136, 163, 162, 169, 207}, 9, false, 206, 63};


//: sessionId
NameureData kStr_colorMerelyValue = (NameureData){231, (Byte []){148, 130, 148, 148, 142, 136, 137, 174, 131, 218}, 9, false, 164, 215};


//: data
NameureData kStr_teenText = (NameureData){24, (Byte []){124, 121, 108, 121, 250}, 4, false, 132, 201};


//: personCardId
NameureData kStr_textAbaseValue = (NameureData){22, (Byte []){102, 115, 100, 101, 121, 120, 85, 119, 100, 114, 95, 114, 64}, 12, false, 189, 235};


//: sendPacketId
NameureData kStr_galText = (NameureData){119, (Byte []){4, 18, 25, 19, 39, 22, 20, 28, 18, 3, 62, 19, 204}, 12, false, 212, 207};


//: encrypted
NameureData kStr_cosyTitle = (NameureData){149, (Byte []){240, 251, 246, 231, 236, 229, 225, 240, 241, 78}, 9, false, 51, 99};


//: content
NameureData kStr_investigationTitle = (NameureData){52, (Byte []){87, 91, 90, 64, 81, 90, 64, 201}, 7, false, 109, 171};


//: compressed
NameureData kStr_namePhysicallyData = (NameureData){124, (Byte []){31, 19, 17, 12, 14, 25, 15, 15, 25, 24, 46}, 10, false, 74, 185};


//: value
NameureData kStr_engineValue = (NameureData){243, (Byte []){133, 146, 159, 134, 150, 111}, 5, false, 54, 65};


//: type
NameureData kStr_rageName = (NameureData){95, (Byte []){43, 38, 47, 58, 4}, 4, false, 70, 70};


//: url
NameureData kStr_wheneverData = (NameureData){144, (Byte []){229, 226, 252, 89}, 3, false, 183, 159};


//: sessionName
NameureData kStr_sayGlanceName = (NameureData){91, (Byte []){40, 62, 40, 40, 50, 52, 53, 21, 58, 54, 62, 1}, 11, false, 179, 111};


//: flag
NameureData kStr_willingValue = (NameureData){205, (Byte []){171, 161, 172, 170, 165}, 4, false, 34, 113};


//: md5
NameureData kStr_operateGageTitle = (NameureData){106, (Byte []){7, 14, 95, 85}, 3, false, 150, 26};


//: password
NameureData kStr_bandValue = (NameureData){81, (Byte []){33, 48, 34, 34, 38, 62, 35, 53, 42}, 8, false, 236, 224};

// __DEBUG__
// __CLOSE_PRINT__
//
//  RecycleMarginDisableDistance.m
//  NIM
//
//  Created by amao on 7/2/15.
//  Copyright (c) 2015 Netease. All rights reserved.
//

// __M_A_C_R_O__
//: #import "NTESCustomAttachmentDecoder.h"
#import "RecycleMarginDisableDistance.h"
//: #import "NTESCustomAttachmentDefines.h"
#import "NTESCustomAttachmentDefines.h"
//: #import "NTESJanKenPonAttachment.h"
#import "TeamAttachment.h"
//: #import "NTESSnapchatAttachment.h"
#import "BackgroundAttachment.h"
//: #import "NTESWhiteboardAttachment.h"
#import "InsertShare.h"
//: #import "NTESRedPacketAttachment.h"
#import "LanguageEnter.h"
//: #import "NTESRedPacketTipAttachment.h"
#import "TitleAttachment.h"
//: #import "NTESMultiRetweetAttachment.h"
#import "RefreshMessage.h"
//: #import "NSDictionary+NTESJson.h"
#import "NSDictionary+ImageGreen.h"
//: #import "NTESSessionUtil.h"
#import "ComponentUtil.h"
//: #import "NTESShareCardAttachment.h"
#import "AggregationTap.h"

//: @implementation NTESCustomAttachmentDecoder
@implementation RecycleMarginDisableDistance
//: - (id<NIMCustomAttachment>)decodeAttachment:(NSString *)content
- (id<NIMCustomAttachment>)decodeAttachment:(NSString *)content
{
    //: id<NIMCustomAttachment> attachment = nil;
    id<NIMCustomAttachment> attachment = nil;

    //: NSData *data = [content dataUsingEncoding:NSUTF8StringEncoding];
    NSData *data = [content dataUsingEncoding:NSUTF8StringEncoding];
    //: if (data) {
    if (data) {
        //: NSDictionary *dict = [NSJSONSerialization JSONObjectWithData:data
        NSDictionary *dict = [NSJSONSerialization JSONObjectWithData:data
                                                             //: options:0
                                                             options:0
                                                               //: error:nil];
                                                               error:nil];
        //: if ([dict isKindOfClass:[NSDictionary class]])
        if ([dict isKindOfClass:[NSDictionary class]])
        {
            //: NSInteger type = [dict jsonInteger:@"type"];
            NSInteger type = [dict plumbSum:StringFromNameureData(&kStr_rageName)];
            //: NSDictionary *data = [dict jsonDict:@"data"];
            NSDictionary *data = [dict info:StringFromNameureData(&kStr_teenText)];
            //: switch (type) {
            switch (type) {
                //: case CustomMessageTypeJanKenPon:
                case CustomMessageTypeJanKenPon:
                {
                    //: attachment = [[NTESJanKenPonAttachment alloc] init];
                    attachment = [[TeamAttachment alloc] init];
                    //: ((NTESJanKenPonAttachment *)attachment).value = [data jsonInteger:@"value"];
                    ((TeamAttachment *)attachment).value = [data plumbSum:StringFromNameureData(&kStr_engineValue)];
                }
                    //: break;
                    break;
                //: case CustomMessageTypeSnapchat:
                case CustomMessageTypeSnapchat:
                {
                    //: attachment = [[NTESSnapchatAttachment alloc] init];
                    attachment = [[BackgroundAttachment alloc] init];
                    //: ((NTESSnapchatAttachment *)attachment).md5 = [data jsonString:@"md5"];
                    ((BackgroundAttachment *)attachment).md5 = [data show:StringFromNameureData(&kStr_operateGageTitle)];
                    //: ((NTESSnapchatAttachment *)attachment).url = [data jsonString:@"url"];
                    ((BackgroundAttachment *)attachment).url = [data show:StringFromNameureData(&kStr_wheneverData)];
                    //: ((NTESSnapchatAttachment *)attachment).isFired = [data jsonBool:@"fired"];
                    ((BackgroundAttachment *)attachment).isFired = [data wearerName:StringFromNameureData(&kStr_sayContent)];
                }
                    //: break;
                    break;
                //: case CustomMessageTypeWhiteboard:
                case CustomMessageTypeWhiteboard:
                {
                    //: attachment = [[NTESWhiteboardAttachment alloc] init];
                    attachment = [[InsertShare alloc] init];
                    //: ((NTESWhiteboardAttachment *)attachment).flag = [data jsonInteger:@"flag"];
                    ((InsertShare *)attachment).flag = [data plumbSum:StringFromNameureData(&kStr_willingValue)];
                }
                    //: break;
                    break;
                //: case CustomMessageTypeRedPacket:
                case CustomMessageTypeRedPacket:
                {
                    //: attachment = [[NTESRedPacketAttachment alloc] init];
                    attachment = [[LanguageEnter alloc] init];
                    //: ((NTESRedPacketAttachment *)attachment).title = [data jsonString:@"title"];
                    ((LanguageEnter *)attachment).title = [data show:StringFromNameureData(&kStr_lawmakerName)];
                    //: ((NTESRedPacketAttachment *)attachment).content = [data jsonString:@"content"];
                    ((LanguageEnter *)attachment).content = [data show:StringFromNameureData(&kStr_investigationTitle)];
                    //: ((NTESRedPacketAttachment *)attachment).redPacketId = [data jsonString:@"redPacketId"];
                    ((LanguageEnter *)attachment).redPacketId = [data show:StringFromNameureData(&kStr_imageLegallyText)];
                    //: ((NTESRedPacketAttachment *)attachment).sendID = [data jsonString:@"redPacketSendID"];
                    ((LanguageEnter *)attachment).sendID = [data show:StringFromNameureData(&kStr_regulatoryText)];

                }
                    //: break;
                    break;
                //: case CustomMessageTypeRedPacketTip:
                case CustomMessageTypeRedPacketTip:
                {
                    //: attachment = [[NTESRedPacketTipAttachment alloc] init];
                    attachment = [[TitleAttachment alloc] init];
                    //: ((NTESRedPacketTipAttachment *)attachment).sendPacketId = [data jsonString:@"sendPacketId"];
                    ((TitleAttachment *)attachment).sendPacketId = [data show:StringFromNameureData(&kStr_galText)];
                    //: ((NTESRedPacketTipAttachment *)attachment).packetId = [data jsonString:@"redPacketId"];
                    ((TitleAttachment *)attachment).packetId = [data show:StringFromNameureData(&kStr_imageLegallyText)];
                    //: ((NTESRedPacketTipAttachment *)attachment).isGetDone = [data jsonString:@"isGetDone"];
                    ((TitleAttachment *)attachment).isGetDone = [data show:StringFromNameureData(&kStr_therapyTitle)];
                    //: ((NTESRedPacketTipAttachment *)attachment).openPacketId = [data jsonString:@"openPacketId"];
                    ((TitleAttachment *)attachment).openPacketId = [data show:StringFromNameureData(&kStr_objectTunValue)];
                }
                    //: break;
                    break;
                //: case CustomMessageTypeMultiRetweet:
                case CustomMessageTypeMultiRetweet:
                {
                    //: attachment = [[NTESMultiRetweetAttachment alloc] init];
                    attachment = [[RefreshMessage alloc] init];
                    //: ((NTESMultiRetweetAttachment *)attachment).url = [data jsonString:@"url"];
                    ((RefreshMessage *)attachment).url = [data show:StringFromNameureData(&kStr_wheneverData)];
                    //: ((NTESMultiRetweetAttachment *)attachment).md5 = [data jsonString:@"md5"];
                    ((RefreshMessage *)attachment).md5 = [data show:StringFromNameureData(&kStr_operateGageTitle)];
                    //: ((NTESMultiRetweetAttachment *)attachment).fileName = [data jsonString:@"fileName"];
                    ((RefreshMessage *)attachment).fileName = [data show:StringFromNameureData(&kStr_withHeyContent)];
                    //: ((NTESMultiRetweetAttachment *)attachment).compressed = [data jsonBool:@"compressed"];
                    ((RefreshMessage *)attachment).compressed = [data wearerName:StringFromNameureData(&kStr_namePhysicallyData)];
                    //: ((NTESMultiRetweetAttachment *)attachment).encrypted = [data jsonBool:@"encrypted"];
                    ((RefreshMessage *)attachment).encrypted = [data wearerName:StringFromNameureData(&kStr_cosyTitle)];
                    //: ((NTESMultiRetweetAttachment *)attachment).password = [data jsonString:@"password"];
                    ((RefreshMessage *)attachment).password = [data show:StringFromNameureData(&kStr_bandValue)];
                    //: ((NTESMultiRetweetAttachment *)attachment).messageAbstract = [data jsonArray:@"messageAbstract"];
                    ((RefreshMessage *)attachment).messageAbstract = [data date:StringFromNameureData(&kStr_trulyTingWillingnessName)];
                    //: ((NTESMultiRetweetAttachment *)attachment).sessionName = [data jsonString:@"sessionName"];
                    ((RefreshMessage *)attachment).sessionName = [data show:StringFromNameureData(&kStr_sayGlanceName)];
                    //: ((NTESMultiRetweetAttachment *)attachment).sessionId = [data jsonString:@"sessionId"];
                    ((RefreshMessage *)attachment).sessionId = [data show:StringFromNameureData(&kStr_colorMerelyValue)];
                }
                    //: break;
                    break;

                //: case CustomMessageTypeCard:
                case CustomMessageTypeCard:
                {
                    //: attachment = [[NTESShareCardAttachment alloc] init];
                    attachment = [[AggregationTap alloc] init];
                    //: ((NTESShareCardAttachment *)attachment).title = [data jsonString:@"title"];
                    ((AggregationTap *)attachment).title = [data show:StringFromNameureData(&kStr_lawmakerName)];
                    //: ((NTESShareCardAttachment *)attachment).type = [data jsonString:@"type"];
                    ((AggregationTap *)attachment).type = [data show:StringFromNameureData(&kStr_rageName)];
                    //: ((NTESShareCardAttachment *)attachment).content = [data jsonString:@"content"];
                    ((AggregationTap *)attachment).content = [data show:StringFromNameureData(&kStr_investigationTitle)];
                    //: ((NTESShareCardAttachment *)attachment).personCardId = [data jsonString:@"personCardId"];
                    ((AggregationTap *)attachment).personCardId = [data show:StringFromNameureData(&kStr_textAbaseValue)];
                }
                    //: break;
                    break;
                //: default:
                default:
                    //: break;
                    break;
            }
            //: attachment = [self checkAttachment:attachment] ? attachment : nil;
            attachment = [self selected:attachment] ? attachment : nil;
        }
    }
    //: return attachment;
    return attachment;
}


//: - (BOOL)checkAttachment:(id<NIMCustomAttachment>)attachment{
- (BOOL)selected:(id<NIMCustomAttachment>)attachment{
    //: BOOL check = NO;
    BOOL check = NO;
    //: if ([attachment isKindOfClass:[NTESJanKenPonAttachment class]])
    if ([attachment isKindOfClass:[TeamAttachment class]])
    {
        //: NSInteger value = [((NTESJanKenPonAttachment *)attachment) value];
        NSInteger value = [((TeamAttachment *)attachment) value];
        //: check = (value>=CustomJanKenPonValueKen && value<=CustomJanKenPonValuePon) ? YES : NO;
        check = (value>=CustomJanKenPonValueKen && value<=CustomJanKenPonValuePon) ? YES : NO;
    }
    //: else if ([attachment isKindOfClass:[NTESSnapchatAttachment class]])
    else if ([attachment isKindOfClass:[BackgroundAttachment class]])
    {
        //: check = YES;
        check = YES;
    }
    //: else if ([attachment isKindOfClass:[NTESShareCardAttachment class]])
    else if ([attachment isKindOfClass:[AggregationTap class]])
    {
        //: check = YES;
        check = YES;
    }
    //: else if ([attachment isKindOfClass:[NTESWhiteboardAttachment class]])
    else if ([attachment isKindOfClass:[InsertShare class]])
    {
        //: NSInteger flag = [((NTESWhiteboardAttachment *)attachment) flag];
        NSInteger flag = [((InsertShare *)attachment) flag];
        //: check = ((flag >= CustomWhiteboardFlagInvite) && (flag <= CustomWhiteboardFlagClose)) ? YES : NO;
        check = ((flag >= CustomWhiteboardFlagInvite) && (flag <= CustomWhiteboardFlagClose)) ? YES : NO;
    }
    //: else if([attachment isKindOfClass:[NTESRedPacketAttachment class]] || [attachment isKindOfClass:[NTESRedPacketTipAttachment class]])
    else if([attachment isKindOfClass:[LanguageEnter class]] || [attachment isKindOfClass:[TitleAttachment class]])
    {
        //: check = YES;
        check = YES;
    }
    //: else if ([attachment isKindOfClass:[NTESMultiRetweetAttachment class]])
    else if ([attachment isKindOfClass:[RefreshMessage class]])
    {
        //: NTESMultiRetweetAttachment *target = (NTESMultiRetweetAttachment *)attachment;
        RefreshMessage *target = (RefreshMessage *)attachment;
        //: if (target.messageAbstract.count == 0) {
        if (target.messageAbstract.count == 0) {
            //: check = NO;
            check = NO;
        //: } else if (target.encrypted && target.password.length == 0) {
        } else if (target.encrypted && target.password.length == 0) {
            //: check = NO;
            check = NO;
        //: } else {
        } else {
            //: check = YES;
            check = YES;
        }
    }
    //: return check;
    return check;
}
//: @end
@end

Byte *NameureDataToByte(NameureData *data) {
    if (data->thanatos) return data->classic;
    for (int i = 0; i < data->column; i++) {
        data->classic[i] ^= data->stock;
    }
    data->classic[data->column] = 0;
    data->thanatos = true;
	if (data->column >= 2) {
		data->toilet = data->classic[0];
		data->successLegally = data->classic[1];
	}
    return data->classic;
}

NSString *StringFromNameureData(NameureData *data) {
    return [NSString stringWithUTF8String:(char *)NameureDataToByte(data)];
}
